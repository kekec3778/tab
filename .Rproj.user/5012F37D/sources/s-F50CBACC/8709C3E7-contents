% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tabglm.R
\name{tabglm}
\alias{tabglm}
\title{Generate Summary Table for Fitted Generalized Linear Model}
\usage{
tabglm(glmfit, latex = FALSE, xlabels = NULL, ci.beta = TRUE,
  inference = "wald", decimals = 2, p.decimals = c(2, 3), p.cuts = 0.01,
  p.lowerbound = 0.001, p.leading0 = TRUE, p.avoid1 = FALSE,
  basic.form = FALSE, intercept = TRUE, n = FALSE, events = FALSE,
  greek.beta = FALSE, binary.compress = TRUE, bold.colnames = TRUE,
  bold.varnames = FALSE, bold.varlevels = FALSE,
  variable.colname = "Variable", print.html = FALSE,
  html.filename = "table1.html")
}
\arguments{
\item{glmfit}{Object returned from \code[stats]{\link{glm}}.}

\item{latex}{Logical value for whether to format table for printing in LaTeX,
e.g. using \code{\link[xtable]{xtable}} [1].}

\item{xlabels}{Character vector with labels for the \code{x} variables and
their levels. Often useful to leave as \code{NULL} first, see how the table
gets displayed, and then re-run with meaningful labels where they need to be.}

\item{ci.beta}{Logical value for whether to include a column with Wald 95\%
confidence intervals for the regression coefficients.}

\item{inference}{Character string specifying method for inference. Choices
are \code{"wald"} for inference based on t or z statistics, depending on the
GLM family (e.g. Gaussian, Poisson, binomial, etc.); \code{"wald.z"} for
inference based on z statistics; \code{"profile"} for confidence intervals
based on profile likelihood (\code{\link[stats]{confint}} function) and
p-values based on t or z statistics, depending on the GLM family; and
\code{"profile.z"}, for confidence intervals based on profile likelihood and
p-values based on z statistics.}

\item{decimals}{Numeric value specifying number of decimal places for numbers
other than p-values.}

\item{p.decimals}{Numeric value specifying number of decimal places for
p-values. Can be a vector if you want the number of decimals to depend on
what range the p-value is in. See \code{p.cuts}.}

\item{p.cuts}{Numeric value or vector of cutpoints to control number of
decimal places for p-values. For example, by default \code{p.cuts = 0.1} and
\code{p.decimals = c(2, 3)}, meaning p-values in the range [0.1, 1] are
printed to 2 decimal places while p-values in the range [0, 0.1) are printed
to 3.}

\item{p.lowerbound}{Numeric value specifying cutpoint beneath which p-values
appear as <p.lowerbound.}

\item{p.leading0}{Logical value for whether p-values should appear with
leading 0's before the decimal point.}

\item{p.avoid1}{Logical value for whether p-values that round to 1 should
appear as \code{>0.99} (or similarly depending on \code{p.decimals} and
\code{p.cuts}) rather than 1.}

\item{basic.form}{Logical value for whether to use a "basic" format for
factor varaibles, rather than attempt to neatly format them. If \code{TRUE},
table will look similar to what \code{summary(glmfit)} displays.}

\item{intercept}{Logical value for whether to include a row for the
intercept.}

\item{n}{Logical value for whether to include a sample size column.}

\item{events}{Logical value for whether to include a number of events column.
Only meaningful when the outcome variable is binary.}

\item{greek.beta}{Logical value for whether to display the Greek letter beta
rather than 'Beta'. Only used if \code{latex = TRUE}.}

\item{binary.compress}{Logical value for whether binary \code{x} factor
variables should be displayed as a single row rather than two.}

\item{bold.colnames}{Logical value for whether to use bold font for column
headings. Only applies if \code{latex = TRUE}.}

\item{bold.varnames}{Logic value for whether to use bold font for the
\code{y} variable name in the first column. Only used if \code{latex = TRUE}.}

\item{bold.varlevels}{Logical value for whether levels of \code{x} factor
variables should appear in bold font in the first column. Only used if
\code{latex = TRUE}.}

\item{variable.colname}{Character string with desired heading for first
column of table, in case you prefer something other than \code{"Variable"}.}

\item{print.html}{Logical value for whether to write a .html file with the
table to the current working directory.}

\item{html.filename}{Character string specifying the name of the .html file
that gets written if \code{print.html = TRUE}.}
}
\value{
Character matrix with table summarizing the fitted GLM.
}
\description{
Creates table summarizing a generalized linear model fit via
\code{\link[stats]{glm}}.
}
\details{
Interaction and polynomial terms are compatible with \code{tabglm}. If
interaction terms are included, the table will be formatted a little
differently. Basically including an interaction is equivalent to setting
\code{basic.form = TRUE}. All variable names and levels will be exactly as
they appear when you run \code{summary(glmfit)}, where \code{glmfit} is the
object returned from a call to \code{\link[stats]{glm}}.
}
\section{Note}{

If you want to paste your tables into Microsoft Word, you can use either of
these approaches:

\enumerate{

\item 1. Use the \code{\link[Kmisc]{write.cb}} function in \pkg{Kmisc} [2].
If your table is stored in a character matrix named \code{table1}, use
\code{write.cb(table1)} to copy the table to your clipboard. Paste the result
into your document, then highlight the text and go to \code{Insert - Table -
Convert Text to Table... OK}.

\item 2. Set \code{print.html = TRUE}. This will result in a .html file
being written to your current working directory. When you open this file, you
will see a (hopefully) nice-looking table that you can copy and paste into
your document. You can control the name of this file with
\code{html.filename}.
}

If you want to use LaTeX, R Markdown, knitr, Sweave, etc., set
\code{latex = TRUE} and then use \code{\link[xtable]{xtable}} [1]. You may
have to set \code{sanitize.text.function = identity} when calling
\code{\link[xtable]{print.xtable}}.
}

\examples{
# Load in sample dataset d and drop rows with missing values
data(d)
d <- d[complete.cases(d), ]

# Create labels for race levels
races <- c("White", "Black", "Mexican American", "Other")

# Test whether age, sex, race, and treatment group are associated with BMI
glmfit1 <- glm(BMI ~ Age + Sex + Race + Group, data = d)
lintable <- tabglm(glmfit = glmfit1,
                   xlabels = c("Intercept", "Age", "Male", "Race", races,
                               "Treatment"))

# Test whether age, sex, race, and treatment group are associated with 1-year
# mortality
glmfit2 <- glm(death_1yr ~ Age + Sex + Race + Group, data = d,
               family = binomial)

logtable <- tabglm(glmfit = glmfit2, ci.beta = FALSE,
                   xlabels = c("Intercept", "Age", "Male", "Race", races,
                               "Treatment"))


}
\references{
1. Dahl, D.B. (2016). xtable: Export Tables to LaTeX or HTML. R package
version 1.8-2, \url{https://cran.r-project.org/package=xtable}.

2. Ushley, K. (2013). Kmisc: Kevin Miscellaneous. R package version 0.5.0.
\url{https://CRAN.R-project.org/package=Kmisc}.
}
